package ch.usi.si.seart.server.controller;

import ch.usi.si.seart.model.user.User;
import ch.usi.si.seart.model.user.token.PasswordResetToken;
import ch.usi.si.seart.model.user.token.VerificationToken;
import ch.usi.si.seart.server.dto.LoginDto;
import ch.usi.si.seart.server.dto.RegisterDto;
import ch.usi.si.seart.server.dto.user.EmailDto;
import ch.usi.si.seart.server.dto.user.PasswordDto;
import ch.usi.si.seart.server.security.TokenProvider;
import ch.usi.si.seart.server.security.UserPrincipal;
import ch.usi.si.seart.server.service.EmailService;
import ch.usi.si.seart.server.service.TokenService;
import ch.usi.si.seart.server.service.UserService;
import ch.usi.si.seart.validation.constraints.OWASPEmail;
import lombok.AccessLevel;
import lombok.RequiredArgsConstructor;
import lombok.experimental.FieldDefaults;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.core.convert.ConversionService;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.annotation.AuthenticationPrincipal;
import org.springf